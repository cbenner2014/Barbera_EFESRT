<div th:fragment="content">
	<!-- Contenedor Principal -->
	<main class="container mx-auto my-8 px-4">
	
		<!-- Botones de acción superiores -->
		<div class="flex flex-wrap justify-between gap-4 mb-8">
		<div class = "flex gap-4">
		
			<a th:href="@{/new-servicio}"
				class="flex items-center px-4 py-2 rounded-md bg-brand-accent text-white font-sans font-medium text-sm hover:bg-brand-accent/80 transition-colors">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2"
					viewBox="0 0 20 20" fill="currentColor">
					<path
						d="M17 9a2 2 0 00-2-2h-2V5a2 2 0 00-2-2H9a2 2 0 00-2 2v2H5a2 2 0 00-2 2v2a2 2 0 002 2h2v2a2 2 0 002 2h2a2 2 0 002-2v-2h2a2 2 0 002-2V9z" /></svg>
				Nuevo Servicio
			</a> 
			
			<a th:href="@{/servicio-report}"
				class="flex items-center px-4 py-2 rounded-md bg-green-500 text-white font-sans font-medium text-sm hover:bg-green-600 transition-colors">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2"
					viewBox="0 0 20 20" fill="currentColor">
					<path fill-rule="evenodd"
						d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
						clip-rule="evenodd" /></svg> Generar Reporte
			</a> 
			</div>
			<a th:href="@{/}"
				
				class="flex items-center px-4 py-2 rounded-md border border-text-primary/20 text-text-primary font-sans font-medium text-sm hover:bg-background-secondary transition-colors">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2"
					viewBox="0 0 20 20" fill="currentColor">
					<path fill-rule="evenodd"
						d="M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z"
						clip-rule="evenodd" /></svg> Menú Principal
			</a>
			
		</div>

		<!-- Contenedor de tarjetas -->
		<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
			<div th:each="servicio : ${servicioList}"
				class="bg-background-secondary rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
				<div class="space-y-3">
					<h3 class="font-sans font-medium text-lg text-text-primary"
						th:text="${servicio.nombreServicio}"></h3>
					<p class="text-sm text-text-primary/80">
						<span class="font-medium">ID:</span> <span
							th:text="${servicio.idServicio}"></span>
					</p>
					<p class="text-sm text-text-primary/80">
						<span class="font-medium">Precio:</span> <span
							th:text="${'S/ ' + #numbers.formatDecimal(servicio.precioServicio, 1, 'COMMA', 2, 'POINT')}"></span>
					</p>
					<p class="text-sm text-text-primary/80">
						<span class="font-medium">Duración:</span> <span
							th:text="${servicio.duracionServicio + ' min'}"></span>
					</p>
					<div class="flex justify-end gap-4 pt-4 w-full">
						<a th:href="@{/edit-servicio/{id}(id=${servicio.idServicio})}"
							class="flex items-center px-3 py-1 rounded-md border border-brand-accent text-brand-accent font-sans text-sm hover:bg-brand-accent hover:text-white transition-colors"
							title="Editar"> Editar </a> <a
							th:href="@{/view-servicio/{id}(id=${servicio.idServicio})}"
							class="flex items-center px-3 py-1 rounded-md border border-text-primary/60 text-text-primary/60 font-sans text-sm hover:bg-text-primary/60 hover:text-white transition-colors"
							title="Ver"> Ver </a>
						<button
							th:onclick="'abrirModalEliminarServicio(' + ${servicio.idServicio} + ')'"
							class="flex items-center px-3 py-1 rounded-md border border-red-500 text-red-500 font-sans text-sm hover:bg-red-500 hover:text-white transition-colors"
							title="Eliminar">Eliminar</button>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!-- Formulario oculto para eliminar -->
	<form id="formEliminarServicio" th:action="@{/remove-servicio/__ID__}"
		method="get" class="hidden"></form>

	<!-- Modal: Servicio Agregado -->
	<div th:if="${servicioAgregado}" id="modalServicioAgregado"
		class="fixed inset-0 flex items-center justify-center bg-black/30 z-50">
		<div
			class="bg-background-primary p-6 rounded-lg shadow-sm text-center max-w-sm w-full">
			<h2 class="text-xl font-sans font-semibold text-green-600 mb-2">Servicio
				registrado</h2>
			<p class="text-sm text-text-primary/80">El servicio se ha
				registrado correctamente.</p>
			<button
				onclick="document.getElementById('modalServicioAgregado').classList.add('hidden')"
				class="mt-4 px-4 py-2 rounded-md bg-green-600 text-white font-sans text-sm hover:bg-green-700 transition-colors">Cerrar</button>
		</div>
	</div>

	<!-- Modal: Servicio Editado -->
	<div th:if="${servicioEditado}" id="modalServicioEditado"
		class="fixed inset-0 flex items-center justify-center bg-black/30 z-50">
		<div
			class="bg-background-primary p-6 rounded-lg shadow-sm text-center max-w-sm w-full">
			<h2 class="text-xl font-sans font-semibold text-blue-600 mb-2">Servicio
				actualizado</h2>
			<p class="text-sm text-text-primary/80">Los datos del servicio se
				han actualizado correctamente.</p>
			<button
				onclick="document.getElementById('modalServicioEditado').classList.add('hidden')"
				class="mt-4 px-4 py-2 rounded-md bg-blue-600 text-white font-sans text-sm hover:bg-blue-700 transition-colors">Cerrar</button>
		</div>
	</div>

	<!-- Modal: Servicio Eliminado -->
	<div th:if="${servicioEliminado}" id="modalServicioEliminado"
		class="fixed inset-0 flex items-center justify-center bg-black/30 z-50">
		<div
			class="bg-background-primary p-6 rounded-lg shadow-sm text-center max-w-sm w-full">
			<h2 class="text-xl font-sans font-semibold text-red-600 mb-2">Servicio
				eliminado</h2>
			<p class="text-sm text-text-primary/80">El servicio ha sido
				eliminado correctamente.</p>
			<button
				onclick="document.getElementById('modalServicioEliminado').classList.add('hidden')"
				class="mt-4 px-4 py-2 rounded-md bg-red-600 text-white font-sans text-sm hover:bg-red-700 transition-colors">Cerrar</button>
		</div>
	</div>

	<!-- Modal: Error al eliminar por citas existentes -->
	<div th:if="${errorEliminacionServicio}"
		id="modalErrorEliminacionServicio"
		class="fixed inset-0 flex items-center justify-center bg-black/30 z-50">
		<div
			class="bg-background-primary p-6 rounded-lg shadow-sm text-center max-w-sm w-full">
			<h2 class="text-xl font-sans font-semibold text-orange-600 mb-2">No
				se puede eliminar</h2>
			<p class="text-sm text-text-primary/80">El servicio tiene citas
				registradas y no puede ser eliminado.</p>
			<button
				onclick="document.getElementById('modalErrorEliminacionServicio').classList.add('hidden')"
				class="mt-4 px-4 py-2 rounded-md bg-orange-600 text-white font-sans text-sm hover:bg-orange-700 transition-colors">Cerrar</button>
		</div>
	</div>

	<!-- Modal: Error genérico -->
	<div th:if="${errorServicio}" id="modalErrorServicio"
		class="fixed inset-0 flex items-center justify-center bg-black/30 z-50">
		<div
			class="bg-background-primary p-6 rounded-lg shadow-sm text-center max-w-sm w-full">
			<h2 class="text-xl font-sans font-semibold text-red-500 mb-2">Error</h2>
			<p class="text-sm text-text-primary/80" th:text="${errorServicio}"></p>
			<button
				onclick="document.getElementById('modalErrorServicio').classList.add('hidden')"
				class="mt-4 px-4 py-2 rounded-md bg-red-600 text-white font-sans text-sm hover:bg-red-700 transition-colors">Cerrar</button>
		</div>
	</div>

	<!-- Modal de confirmación para eliminar -->
	<div id="modalConfirmacionEliminarServicio"
		class="fixed inset-0 bg-black/30 z-50 hidden flex items-center justify-center">
		<div
			class="bg-background-primary p-6 rounded-lg shadow-sm w-full max-w-sm">
			<h2
				class="text-lg font-sans font-semibold text-red-600 mb-3 text-center">¿Eliminar
				este servicio?</h2>
			<p class="text-sm text-text-primary/80 text-center mb-4">Esta
				acción no se puede deshacer.</p>
			<div class="flex justify-center gap-3">
				<button onclick="cerrarModalEliminarServicio()"
					class="px-4 py-2 rounded-md bg-background-secondary text-text-primary font-sans text-sm hover:bg-background-secondary/80 transition-colors">Cancelar</button>
				<button onclick="confirmarEliminarServicio()"
					class="px-4 py-2 rounded-md bg-red-500 text-white font-sans text-sm hover:bg-red-600 transition-colors">Eliminar</button>
			</div>
		</div>
	</div>
</div>
<script>
        let servicioIdEliminar = null;

        function abrirModalEliminarServicio(id) {
            servicioIdEliminar = id;
            const modal = document.getElementById("modalConfirmacionEliminarServicio");
            modal.classList.remove("hidden");
            modal.classList.add("flex");
        }

        function cerrarModalEliminarServicio() {
            const modal = document.getElementById("modalConfirmacionEliminarServicio");
            modal.classList.remove("flex");
            modal.classList.add("hidden");
            servicioIdEliminar = null;
        }

        function confirmarEliminarServicio() {
            if (servicioIdEliminar !== null) {
                const form = document.getElementById("formEliminarServicio");
                const action = `/remove-servicio/${servicioIdEliminar}`;
                form.setAttribute("action", action);
                form.submit();
            }
        }
    </script>

<script>
        window.addEventListener("DOMContentLoaded", () => {
            const modales = [
                "modalServicioAgregado",
                "modalServicioEditado",
                "modalServicioEliminado",
                "modalErrorEliminacionServicio",
                "modalErrorServicio"
            ];

            modales.forEach(id => {
                const modal = document.getElementById(id);
                if (modal) {
                    // Mostrar el modal si existe
                    modal.classList.remove("hidden");
                    modal.classList.add("flex");

                    // Cierre automático después de 4 segundos
                    setTimeout(() => {
                        modal.classList.add("hidden");
                        modal.classList.remove("flex");
                    }, 4000);
                }
            });
        });
    </script>
</div>